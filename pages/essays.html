<div
  x-data="essayList()"
  x-init="loadEssays(); initScrollSpy()"
  class="w-full max-w-7xl mx-auto px-4 py-12"
>
  <!-- MOBILE LAYOUT -->
  <div class="lg:hidden" x-data="{ openEssay: null }">
    <template x-for="section in sections" :key="section.id">
      <div class="mb-6">
        <h2
          class="text-xl font-semibold mb-2 border-b border-secondary pb-1 font-heading"
          x-text="section.label"
        ></h2>
        <ul class="space-y-1">
          <template x-for="essay in filteredEssays(section.id)" :key="essay.id">
            <li class="border-b border-gray-200">
              <!-- Essay title -->
              <button
                @click="openEssay = openEssay === essay.id ? null : essay.id; loadEssay(essay)"
                class="w-full text-left py-2 text-sm flex justify-between items-center"
                :class="openEssay === essay.id ? 'text-accent font-semibold' : 'text-gray-700 hover:text-secondary'"
              >
                <span x-text="essay.title"></span>
                <span x-text="openEssay === essay.id ? '−' : '+'"></span>
              </button>

              <!-- Essay content -->
              <div
                x-show="openEssay === essay.id"
                x-collapse
                class="prose px-1 pb-4"
                x-html="essayContent"
              ></div>
            </li>
          </template>
        </ul>
      </div>
    </template>

    <!-- Back to top button -->
    <button
      x-show="openEssay !== null"
      @click="window.scrollTo({ top: 0, behavior: 'smooth' }); openEssay = null"
      class="fixed bottom-6 right-6 bg-accent text-white rounded-full w-10 h-10 flex items-center justify-center shadow-lg"
    >
      ↑
    </button>
  </div>

  <!-- DESKTOP GRID -->
  <div class="hidden lg:grid lg:grid-cols-4 gap-12">
    <!-- Sidebar -->
    <aside class="lg:col-span-1 sticky top-24 self-start">
      <nav>
        <template x-for="section in sections" :key="section.id">
          <div class="mb-6">
            <span
              class="block text-lg font-semibold text-black"
              x-text="section.label"
